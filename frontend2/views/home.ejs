<%- include('partials/home/header') %>






    <div class="welcome-area pt-120">
  <div class="container">
    <div class="row justify-content-center">
      <div class="col-12 col-md-10 col-xl-8">
        <div class="welcome-content text-center">
          <h2 data-aos="fade-up" data-aos-duration="750" data-aos-delay="300">
            Revolutionizing the Coupon Industry with NFTs: Welcome to KooponCraft
          </h2>
          <p class="mb-4" data-aos="fade-up" data-aos-duration="750" data-aos-delay="500">
            Imagine you get a coupon for a free cup of coffee. With KooponCraft, 
            you could redeem that for your drink‚Äîor, if coffee isn‚Äôt your thing, 
            you could sell it to someone else who really wants it. The possibilities are endless.
          </p>
          <a class="btn btn-primary rounded-pill" href="/shop" data-aos="fade-up" data-aos-duration="750" data-aos-delay="800">
            <i class="me-2 bi bi-grid-3x3-gap"></i> View All Items
          </a>
        </div>
      </div>
    </div>
  </div>
</div>
    <div class="divider"></div>

    <!-- new items container -->
    <div class="live-bidding-wrapper">
      <div class="container">
        <div class="row align-items-center">
          <div class="col-7">
            <div class="section-heading d-flex align-items-center">
              <!-- <div class="spinner-grow text-danger" role="status"><span class="visually-hidden">Loading...</span></div> -->
              <h2 class="mb-0 ms-3">Latest Items in our stores</h2>
            </div>
          </div>
          <div class="col-5 text-end"><a class="btn rounded-pill btn-outline-primary btn-sm border-2 mb-5" href="/shop">View All Items</a></div>
        </div>
      </div>
      <div class="container">
        <div class="row g-4 justify-content-center" id="itemsContainer">



        </div>
      </div>
    </div>
  <!-- end: new items container -->

    <div class="divider"></div>


    <!-- process of kooponcraft -->
    <div class="process-wrapper" data-aos="zoom-in" data-aos-duration="500" data-aos-delay="200">
      <div class="container">
        <div class="row g-4 g-xxl-5 align-items-center justify-content-center">
          <div class="col-12 col-sm-6 col-xl-3">
            <!-- Single Card-->
            <div class="single-process-card card bg-gray border-0" data-aos="fade-up" data-aos-duration="750" data-aos-delay="400">
              <div class="card-body p-4 text-center"><img class="mb-3 mx-auto" src="/assets/img/illustrator/4.png" alt="">
                <h5 class="mb-3">Sign Up &amp; Create wallet</h5>
                <p class="mb-0">
                    Join the KooponCraft community by signing up and creating your digital wallet.
                </p>
              </div>
              <!-- Step -->
              <div class="step-number">1</div>
            </div>
          </div>
          <div class="col-12 col-sm-6 col-xl-3">
            <!-- Single Card-->
            <div class="single-process-card card bg-gray border-0" data-aos="fade-up" data-aos-duration="750" data-aos-delay="600">
              <div class="card-body p-4 text-center"><img class="mb-3 mx-auto" src="/assets/img/illustrator/2.png" alt="">
                <h5 class="mb-3">Start shopping. Browse the Marketplace</h5>
                <p class="mb-0">
                    Explore stores on the KooponCraft marketplace to find exciting items like 
                    home appliances, materials, and other exclusive products.
                </p>
              </div>
              <!-- Step -->
              <div class="step-number">2</div>
            </div>
          </div>
          <div class="col-12 col-sm-6 col-xl-3">
            <!-- Single Card-->
            <div class="single-process-card card bg-gray border-0" data-aos="fade-up" data-aos-duration="750" data-aos-delay="800">
              <div class="card-body p-4 text-center"><img class="mb-3 mx-auto" src="/assets/img/illustrator/3.png" alt="">
                <h5 class="mb-3">Make a Purchase</h5>
                <p class="mb-0">
                    Purchase any item using your wallet, and automatically stand a chance to 
                    win a coupon that can be redeemed, sold, or traded within the platform.
                </p>
              </div>
              <!-- Step -->
              <div class="step-number">3</div>
            </div>
          </div>
          <div class="col-12 col-sm-6 col-xl-3">
            <!-- Single Card-->
            <div class="single-process-card card bg-gray border-0" data-aos="fade-up" data-aos-duration="750" data-aos-delay="1000">
              <div class="card-body p-4 text-center"><img class="mb-3 mx-auto" src="/assets/img/illustrator/1.png" alt="">
                <h5 class="mb-3">Redeem or Trade Your Coupons</h5>
                <p class="mb-0">
                    After winning a coupon, use it to unlock discounts, 
                    or trade it with other users on the platform. You control how 
                    you use your winnings!</p>
              </div>
              <!-- Step -->
              <div class="step-number">4</div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- end: process of kooponcraft -->


    <div class="divider"></div>
    <div class="discover-nft-wrapper bg-gray pt-120 pb-120">
      <div class="container">
        <div class="section-heading">
          <h2 class="mb-0">Discover Stores</h2>
        </div>
      </div>
      <!-- Discover Filter Options-->
      <div class="discover-filter-options mb-5">
        <div class="container">
          <div class="row g-4 justify-content-center">
            <div class="col-12 col-sm-6 col-lg-6">
              <h3>Oops!ü§ß We're currently working on this. Stay tunedüôè</h3>
            </div>
            
          </div>
        </div>
      </div>
    </div>
    <div class="divider"></div>


    <!-- CTA Wrapper -->
    <div class="container">
      <div class="cta-text bg-gradient p-4 p-sm-5 bg-primary" data-aos="zoom-in" data-aos-duration="750" data-aos-delay="300">
        <div class="row align-items-center">
          <div class="col-12 col-md-8 col-lg-9">
            <h2 class="mb-3 mb-md-0" data-aos="fade-up" data-aos-duration="750" data-aos-delay="600">Resources for getting started with KooponCraft.</h2>
          </div>
          <div class="col-12 col-md-4 col-lg-3">
            <div class="text-md-end"><a class="btn btn-warning rounded-pill" href="#" data-aos="zoom-in" data-aos-duration="750" data-aos-delay="900">Get Started</a></div>
          </div>
        </div>
      </div>
    </div>
    
    <div class="divider"></div>
    <!-- App Download -->
    <div class="app-download-wrapper">
      <div class="container">
        <div class="row align-items-center justify-content-center g-4 g-lg-5">
          <div class="col-12 col-lg-6">
            <div class="download-text text-center text-lg-start">
              <h2 class="mb-3" data-aos="fade-up" data-aos-duration="750" data-aos-delay="200">Stay connected <br> to all your devices.</h2>
              <p class="mb-5" data-aos="fade-up" data-aos-duration="750" data-aos-delay="300">Our mobile apps <span class="text-danger">coming soon</span>. Stay anticipated.</p>
              <div class="row align-items-center justify-content-center justify-content-lg-start g-5">
                <!-- <div class="col-5 border-end">
                  <div class="qr-code-wrapper" data-aos="fade-up" data-aos-duration="750" data-aos-delay="500"><img class="p-3 bg-white shadow rounded border w-100" src="/assets/img/core-img/qr-code.svg" alt=""></div>
                </div> -->
                <div class="col-5">
                  <div class="app-btn-groups text-start">
                    <button class="btn p-0 mb-4 w-100" type="button" data-aos="fade-up" data-aos-duration="750" data-aos-delay="700"><img src="/assets/img/core-img/google-play.png" alt=""></button>
                    <button class="btn p-0 w-100" type="button" data-aos="fade-up" data-aos-duration="750" data-aos-delay="800"><img src="/assets/img/core-img/app-store.png" alt=""></button>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="col-12 col-sm-8 col-lg-6">
            <div class="download-img"><img src="/assets/img/illustrator/2.png" alt=""></div>
          </div>
        </div>
      </div>
    </div>
    <div class="divider"></div>
    
    <!-- Dark Light Wrapper -->
    <div class="dark-light-wrapper" data-aos="zoom-in" data-aos-duration="750" data-aos-delay="200">
      <div class="container">
        <div class="d-flex align-items-center justify-content-between">
          <h5 class="mb-0 text-white" data-aos="fade-up" data-aos-duration="750" data-aos-delay="500">Light mode is available!</h5>
          <!-- Switch -->
          <div class="dark-light-mode" data-aos="fade-up" data-aos-duration="750" data-aos-delay="800">
            <input id="darkLightSwitch" type="checkbox">
            <label class="shadow" for="darkLightSwitch">Toggle</label>
          </div>
        </div>
      </div>
    </div>







<%- include('partials/home/footer') %>

<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<!-- handle list of items dynamically -->
<script>
$(document).ready(function () {
  let currentLimit = 10; // Start with 10 items
  const increment = 10; // Number of items to load each time

  // Fetch and display items
  function loadItems(limit) {
    $.ajax({
      url: `/api/getItems?limit=${limit}`,
      method: "GET",
      success: function (response) {
        if (response.success) {
          const items = response.items;
          let itemsHTML = "";
          items.forEach((item) => {
            itemsHTML += `
            <div class="col-12 col-sm-6 col-lg-4 col-xl-3">
            <div class="nft-card card shadow-sm">
              <div class="card-body">
              <div class="img-wrap">
                <img src="${item.itemImage}" alt="${item.nameOfItem}">
                <!-- Badge -->
                <div class="badge bg-dark position-absolute">
                  <img src="/assets/img/core-img/fire.png" alt="">${item.isHotSale ? 'Hot Sale' : 'New Item'}
                </div>
                <!-- Dropdown -->
                <div class="dropdown">
                  <button class="btn dropdown-toggle rounded-pill shadow-sm" id="dropdownqwa22" type="button" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi bi-three-dots-vertical"></i></button>
                  <!-- Dropdown Menu -->
                  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdownqwa22">
                    <li><a class="dropdown-item" href="#"><i class="me-1 bi bi-share"></i>Share</a></li>
                    <li><a class="dropdown-item" href="#"><i class="me-1 bi bi-flag"></i>Report</a></li>
                  </ul>
                </div>
              </div>
              <!-- Others Info -->
              <div class="row gx-2 align-items-center mt-3">
                <div class="col-8">
                    <span class="d-block fz-12"><i class="bi bi-bag me-1"></i>Available</span>
                </div>
                <div class="col-4 text-end">
                  <button class="wishlist-btn" type="button"><i class="bi"></i></button>
                </div>
              </div>
              <!-- Meta Info -->
              <div class="row gx-2 align-items-center mt-2">
                <div class="col-8">
                  <div class="name-info d-flex align-items-center">
                    <div class="author-img position-relative">
                      <img class="shadow" src="/assets/img/bg-img/u4.jpg" alt="">
                      <i class="bi bi-check position-absolute bg-success"></i>
                    </div>
                    <div class="name-author">
                      <a class="name d-block hover-primary fw-bold text-truncate" href="#" data-bs-toggle="tooltip" data-bs-placement="top" title="${item.nameOfItem}">${item.nameOfItem}</a>
                      <a class="author d-block fz-12 hover-primary text-truncate" href="#">@${item.itemOwner}</a>
                    </div>
                  </div>
                </div>
                <div class="col-4">
                  <div class="price text-end">
                    <span class="fz-12 d-block">Price</span>
                    <h6 class="mb-0">${item.priceOfItem} UNQ</h6>
                  </div>
                </div>
                <div class="col-12">
                  <a class="btn btn-primary rounded-pill btn-sm mt-3 w-100" href="#" data-item-id="${item._id}">Purchase Now</a>
                </div>
              </div>
              </div>
              </div>
              </div>
            `;
          });

          // Append items to the #itemsContainer
          $("#itemsContainer").append(itemsHTML);

          // If fewer items are returned than requested, hide the "Load More" button
          if (items.length < increment) {
            $("#load-more").hide();
          } else {
            $("#load-more").show();
          }

          // Connect click handler to dynamically created buttons
          attachPurchaseHandlers();
        } else {
          $("#itemsContainer").html("<p>No items found.</p>");
        }
      },
      error: function (jqXHR, textStatus, errorThrown) {
        $("#itemsContainer").html("<p>Error fetching items.</p>");
      },
    });
  }
  // End: fetch and display items

  // Handle purchase 
  function attachPurchaseHandlers() {
    $('.btn-primary').off('click').on('click', function(event) {
      event.preventDefault(); 

      const itemId = $(this).data('item-id'); // get the item id from data attribute
      const quantity = 1; // say quantity is always 1 for simplicity

      // get the token from localStorage
      const token = localStorage.getItem("token");

      $.ajax({
        url: '/api/purchaseItem', 
        method: 'POST',
        contentType: 'application/json', 
        data: JSON.stringify({
          itemId: itemId,
          quantity: quantity
        }),
        headers: {
          Authorization: `Bearer ${token}` 
        },
        success: function(response) {
          if (response.success) {
            // showSuccessToast("Successfully purchased 1 unit!");
            toastr.success("Successfully purchased 1 unit!");
          } else {
            alert('Error: ' + response.error);
          }
        },
        error: function(jqXHR, textStatus, errorThrown) {
          alert('Error: ' + errorThrown);
        }
      });
    });
  }
  
  // End: handle purchase 

  // Load initial items
  loadItems(currentLimit);

  // Handle Load More button click
  $("#load-more").on('click', function() {
    currentLimit += increment; // Increase the limit
    loadItems(currentLimit); // Load more items
  });
});
</script>